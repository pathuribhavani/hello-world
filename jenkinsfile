pipeline{
    agent any
    environment{
    registry = "https://hub.docker.com/repository/docker/bhavanipathuri/webfile"
    registryCredential = 'dockerhub'
    }
        tools{
        maven 'M2_HOME'
        jdk '$JAVA_HOME'
        }
        stages{
            stage('Initialize'){
            steps{
                sh '''
                echo "PATH=${PATH}"
                echo "M2_HOME = ${M2_HOME}"
                '''
            }
        }
        stage('Checkout') {
            steps{
                git credentialsId: 'bhavani', url: 'https://github.com/pathuribhavani/hello-world'
                
            }
        }
	stage('Build'){
            steps{
                sh 'mvn -version'
                sh 'mvn clean install'
                
                }
            }
	stage('Docker Image') {
	         steps{
 		
                  sh "docker build -t registry/pathuribhavani/webfile:${1234} ."
	          sh "docker run -itd registry/pathuribhavani/webfile:${1234} /bin/bash"
	          sh './image_push.sh'
                  sh 'docker-compose up -d'
        }
                    
    }
		  stage(‘Push Image to Docker Hub ‘) {
                  steps{
                  script {
                  docker.withRegistry( ‘’, registryCredential ) {
                  dockerImage.push()
                  dockerImage.push(‘latest’)	







}}
 }      }	


}

}
